(()=>{"use strict";const e=function(){const e=document.createElement("div");e.classList.add("container"),function(e){const t=document.createElement("div"),s=document.createElement("h1");t.classList.add("project-title"),s.innerText="BattleShip!",t.appendChild(s),e.appendChild(t)}(e),function(e){const t=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div");t.classList.add("game-board"),s.classList.add("grid"),s.classList.add("grid-user"),i.classList.add("div"),i.classList.add("grid-cpu"),i.classList.add("hide"),t.appendChild(s),t.appendChild(i),function(e){const t=document.createElement("div"),s=document.createElement("h3"),i=document.createElement("div");t.classList.add("instructions"),i.classList.add("ship-display"),s.innerText="Click on ships to rotate horizontal/vertical then drag over grid.",s.style.color="white",s.style.margin="10px 10px",t.appendChild(s),i.appendChild(t);const n={carrier:5,battleship:4,cruiser:3,submarine:3,destroyer:2};for(const e in n){const t=document.createElement("div");t.classList.add("ship"),t.classList.add(`${e}-container`),t.setAttribute("draggable",!0);for(let s=0;s<n[e];s++){const i=document.createElement("div");i.id=`${e}-${s}`,t.appendChild(i)}i.appendChild(t)}e.appendChild(i)}(t),e.appendChild(t)}(e),function(e){const t=document.createElement("div"),s=document.createElement("button"),i=document.createElement("button");t.classList.add("buttons"),t.classList.add("hide"),i.classList.add("hide"),s.id="start",i.id="replay",s.innerText="Start",i.innerText="Play Again",t.appendChild(s),t.appendChild(i),e.appendChild(t)}(e),function(e){const t=document.createElement("div"),s=document.createElement("h3"),i=document.createElement("h3");t.classList.add("info"),s.id="turn",i.id="game-status",t.appendChild(s),t.appendChild(i),e.appendChild(t)}(e),document.body.appendChild(e)},t=function(){return{createGrid:function(e,t){for(let s=0;s<100;s++){const i=document.createElement("div");i.classList.add("cell"),i.dataset.id=s,e.appendChild(i),t.push(i)}},receiveAttack:function(e,t,s){let i;return e[t].classList.contains("hit")||e[t].classList.contains("miss")||(e[t].classList.contains("destroyer")?(e[t].classList.add("hit"),s[0].hit(t),i="Succesful hit on destroyer!"):e[t].classList.contains("submarine")?(e[t].classList.add("hit"),s[1].hit(t),i="Succesful hit on submarine!"):e[t].classList.contains("cruiser")?(e[t].classList.add("hit"),s[2].hit(t),i="Succesful hit on cruiser!"):e[t].classList.contains("battleship")?(e[t].classList.add("hit"),s[3].hit(t),i="Succesful hit on battleship!"):e[t].classList.contains("carrier")?(e[t].classList.add("hit"),s[4].hit(t),i="Succesful hit on carrier!"):e[t].classList.contains("occupied")||(e[t].classList.add("miss"),i="Missed!")),i}}},s=function(e){let t=[];const s=e;return{shipLength:s,hit:e=>(null==e||t.push(e),t),isSunk:()=>t.length==s}},i=function(){const n=document.querySelector(".grid-user"),c=document.querySelector(".grid-cpu"),a=document.querySelector("#start"),d=document.querySelector("#replay");let r=document.querySelector("#turn");const o=document.querySelector("#game-status"),l=s(2),u=s(3),h=s(3),m=s(4),p=s(5),L=s(2),f=s(3),v=s(3),E=s(4),g=s(5);let S=[],y=[],C=[],b=!1,k="user";function x(e){let t=Math.floor(Math.random()*e.directions.length),s=e.directions[t];const i=0===t?1:10;let n=Math.abs(Math.floor(Math.random()*y.length-e.directions[0].length*i));const c=s.some((e=>y[n+e].classList.contains("occupied"))),a=s.some((e=>(n+e)%10==9)),d=s.some((e=>(n+e)%10==0));c||a||d?x(e):s.forEach((t=>y[n+t].classList.add("occupied",e.name)))}function q(){!0!==b&&("user"===k?(r.innerText="Your turn",y.forEach((e=>e.addEventListener("click",T)))):(r.innerText="Computer's turn",setTimeout(M,1e3)))}function T(e){const s=[L,f,v,E,g],i=e.target.dataset.id;y[i].removeEventListener("click",T),t().receiveAttack(y,i,s),l.isSunk()&&u.isSunk()&&h.isSunk()&&m.isSunk()&&p.isSunk()?(o.innerText="You lost!",$()):L.isSunk()&&f.isSunk()&&v.isSunk()&&E.isSunk()&&g.isSunk()&&(o.innerText="You win!",$()),k="computer",q()}function M(){let e=[l,u,h,m,p],s=Math.floor(Math.random()*S.length);C.includes(s)?M():(t().receiveAttack(S,s,e),C.push(s)),r.innerText="Your turn"}function $(){b=!0,r.classList.add("hide"),y.forEach((e=>e.removeEventListener("click",T))),d.classList.remove("hide")}t().createGrid(n,S),t().createGrid(c,y),function(t){const s=document.querySelector("#replay"),n=document.querySelector(".ship-display"),c=document.querySelectorAll(".ship"),a=document.querySelector(".buttons");let d,r,o;function l(e){const t=e.target.parentNode.classList[1];document.querySelector(`.${t}`).classList.toggle(`${t}-vertical`)}function u(e){r=e.target,o=r.children.length}function h(e){e.preventDefault()}function m(e){e.preventDefault()}function p(){let e=r.children[o-1].id,s=e.slice(0,-2),i=parseInt(e.substr(-1)),c=i+parseInt(this.dataset.id),l=parseInt(d.substr(-1));c-=l;let u=[0,10,20,30,40,50,60,70,80,90,1,11,21,31,41,51,61,71,81,91,2,12,22,32,42,52,62,72,82,92,3,13,23,33,43,53,63,73,83,93].splice(0,10*i),h=[99,98,97,96,95,94,93,92,91,90,89,88,87,86,85,84,83,82,81,80,79,78,77,76,75,74,73,72,71,70,69,68,67,66,65,64,63,62,61,60].splice(0,10*i),m=[];for(let e=0;e<o;e++)r.classList.contains(`${s}-container-vertical`)?r.classList.contains(`${s}-container-vertical`)&&m.push(t[parseInt(this.dataset.id)-l+10*e+1]):m.push(t[parseInt(this.dataset.id)-l+e]);if(r.classList.contains(`${s}-container-vertical`)||u.includes(c)){if(!r.classList.contains(`${s}-container-vertical`)||h.includes(c))return;if(!m.some((e=>e.classList.contains("occupied")))){for(let e=0;e<o;e++)t[parseInt(this.dataset.id)-l+10*e+1].classList.add("occupied",s);n.removeChild(r)}}else if(!m.some((e=>e.classList.contains("occupied")))){for(let e=0;e<o;e++)t[parseInt(this.dataset.id)-l+e].classList.add("occupied",s);n.removeChild(r)}n.children.length<=1&&(n.classList.add("hide"),a.classList.remove("hide"))}s.addEventListener("click",(function(){for(;document.body.firstChild;)document.body.removeChild(document.body.firstChild);e(),i()})),c.forEach((e=>e.addEventListener("dragstart",u))),c.forEach((e=>e.addEventListener("click",l))),c.forEach((e=>e.addEventListener("mousedown",(e=>{d=e.target.id})))),t.forEach((e=>e.addEventListener("dragstart",u))),t.forEach((e=>e.addEventListener("dragover",h))),t.forEach((e=>e.addEventListener("dragenter",m))),t.forEach((e=>e.addEventListener("drop",p)))}(S),a.addEventListener("click",(()=>{a.classList.add("hide"),c.classList.remove("hide"),o.innerText="Red = Hit \nBlue = Missed",q()})),[{name:"carrier",directions:[[0,1,2,3,4],[0,10,20,30,40]]},{name:"battleship",directions:[[0,1,2,3],[0,10,20,30]]},{name:"submarine",directions:[[0,1,2],[0,10,20]]},{name:"cruiser",directions:[[0,1,2],[0,10,20]]},{name:"destroyer",directions:[[0,1],[0,10]]}].forEach((e=>x(e)))};document.addEventListener("DOMContentLoaded",(()=>{e(),i()}))})();